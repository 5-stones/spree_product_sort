<%= render :partial => 'spree/admin/shared/product_sub_menu' %>

<h1>Reorder Categories</h1>

<ul class="products_ul" id='taxons_ul'>
  <% Spree::Taxon.order('nav_position ASC').each do |taxon| %>
    <% unless taxon.name == 'Category' %>
      <li id="taxon_<%= taxon.id %>">
       <span class="handle">â‰¡</span>
       <%= h taxon.name %>
      </li>
    <% end %>
<% end %>
</ul>




<h1>Reorder Products within Categories</h1>

<% @taxons.each do |taxon| %>
  <h2><%= taxon.name %></h2>
  
  <%= render :partial=> 'product_list', :locals => {:taxon => taxon} %>
	<% content_for :head do %>
	  <script type="text/javascript">
			jQuery(document).ready(function(){
			  $('ul#products_ul').sortable(
			    { items:'li',
			      containment:'parent',
			      axis:'y',
			      handle:'.handle',
			      update: function(){
			        $.post('/admin/taxons/reorder_products/<%=taxon.id || 0%>',
			               '_method=put&'+$(this).sortable('serialize'))
			      }
			    }
			  );
			  $('ul#taxons_ul').sortable(
			    { items:'li',
			      containment:'parent',
			      axis:'y',
			      handle:'.handle',
			      update: function(){
			        $.post('/admin/taxons/reorder_taxons/',
			               '_method=put&'+$(this).sortable('serialize'))
			      }
			    }
			  )
			});
	  </script>
	<% end %>
<% end %>
